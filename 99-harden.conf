net.ipv4.tcp_mtu_probing = 1
net.ipv4.route.min_pmtu = 576

net.nf_conntrack_max = 131072                   # Alias for max connections (match reduced size)

net.netfilter.nf_conntrack_acct = 0             # Disable connection accounting (security/privacy)
net.netfilter.nf_conntrack_buckets = 131072     # Reduced from 262144: Limits hash table size (DoS protection)
net.netfilter.nf_conntrack_checksum = 1         # Enable checksum validation (critical for security)
net.netfilter.nf_conntrack_count = 17           # Read-only current connection count
net.netfilter.nf_conntrack_dccp_loose = 0       # Disable loose DCCP handling (strict protocol compliance)
net.netfilter.nf_conntrack_dccp_timeout_closereq = 30  # Aggressive DCCP timeout (reduced from 64)
net.netfilter.nf_conntrack_dccp_timeout_closing = 30   # Reduced from 64
net.netfilter.nf_conntrack_dccp_timeout_open = 3600    # Reduced from 43200 (1hr max)
net.netfilter.nf_conntrack_dccp_timeout_partopen = 120 # Reduced from 480
net.netfilter.nf_conntrack_dccp_timeout_request = 60   # Reduced from 240
net.netfilter.nf_conntrack_dccp_timeout_respond = 120  # Reduced from 480
net.netfilter.nf_conntrack_dccp_timeout_timewait = 60  # Reduced from 240
net.netfilter.nf_conntrack_events = 1           # Enable event tracking (2→1: disable group events)
net.netfilter.nf_conntrack_expect_max = 256     # Reduced from 4096 (limits port forwarding)
net.netfilter.nf_conntrack_frag6_high_thresh = 1048576  # Reduced fragment memory (DoS protection)
net.netfilter.nf_conntrack_frag6_low_thresh = 786432    # Reduced accordingly
net.netfilter.nf_conntrack_frag6_timeout = 30   # Reduced from 60 (faster fragment cleanup)
net.netfilter.nf_conntrack_generic_timeout = 120 # Reduced from 600 (generic connection timeout)
net.netfilter.nf_conntrack_gre_timeout = 20      # Reduced from 30 (VPN/PPP security)
net.netfilter.nf_conntrack_gre_timeout_stream = 90 # Reduced from 180
net.netfilter.nf_conntrack_icmp_timeout = 10    # Reduced from 30 (prevent ICMP flooding)
net.netfilter.nf_conntrack_icmpv6_timeout = 10  # Reduced from 30
net.netfilter.nf_conntrack_log_invalid = 1      # Enable logging of invalid packets (0→1 for detection)
net.netfilter.nf_conntrack_max = 131072         # Reduced from 262144 (limits connection exhaustion attacks)
net.netfilter.nf_conntrack_sctp_timeout_closed = 5 # Reduced from 10
net.netfilter.nf_conntrack_sctp_timeout_cookie_echoed = 2 # Reduced from 3
net.netfilter.nf_conntrack_sctp_timeout_cookie_wait = 2   # Reduced from 3
net.netfilter.nf_conntrack_sctp_timeout_established = 300 # Reduced from 210→300 (allow some margin)
net.netfilter.nf_conntrack_sctp_timeout_heartbeat_sent = 15 # Reduced from 30
net.netfilter.nf_conntrack_sctp_timeout_shutdown_ack_sent = 2 # Reduced from 3
net.netfilter.nf_conntrack_sctp_timeout_shutdown_recd = 2  # Reduced from 3
net.netfilter.nf_conntrack_sctp_timeout_shutdown_sent = 2  # Reduced from 3
net.netfilter.nf_conntrack_tcp_be_liberal = 0   # Disable liberal TCP mode (strict validation)
net.netfilter.nf_conntrack_tcp_ignore_invalid_rst = 0 # Validate RST packets
net.netfilter.nf_conntrack_tcp_loose = 0        # Disable loose TCP mode (prevent state bypass)
net.netfilter.nf_conntrack_tcp_max_retrans = 3  # Mark connections dead after 3 retransmits (default)
net.netfilter.nf_conntrack_tcp_timeout_close = 5 # Reduced from 10
net.netfilter.nf_conntrack_tcp_timeout_close_wait = 30 # Reduced from 60
net.netfilter.nf_conntrack_tcp_timeout_established = 86400 # Increased to 24hr (compatibility)
net.netfilter.nf_conntrack_tcp_timeout_fin_wait = 30  # Reduced from 120
net.netfilter.nf_conntrack_tcp_timeout_last_ack = 15  # Reduced from 30
net.netfilter.nf_conntrack_tcp_timeout_max_retrans = 120 # Reduced from 300
net.netfilter.nf_conntrack_tcp_timeout_syn_recv = 30   # Reduced from 60 (SYN flood protection)
net.netfilter.nf_conntrack_tcp_timeout_syn_sent = 60   # Reduced from 120
net.netfilter.nf_conntrack_tcp_timeout_time_wait = 30  # Reduced from 120
net.netfilter.nf_conntrack_tcp_timeout_unacknowledged = 120 # Reduced from 300
net.netfilter.nf_conntrack_timestamp = 1        # Enable timestamps (0→1 for connection validation)
net.netfilter.nf_conntrack_udp_timeout = 15     # Reduced from 30 (UDP flood protection)
net.netfilter.nf_conntrack_udp_timeout_stream = 60 # Reduced from 120

net.netfilter.nf_flowtable_tcp_timeout = 15     # Half default (flowtable security)
net.netfilter.nf_flowtable_udp_timeout = 15
net.netfilter.nf_hooks_lwtunnel = 0             # Disable LWT hooks (reduce attack surface)

net.netfilter.nf_log.0 = NONE                   # Disable NF_LOG_UNSPEC
net.netfilter.nf_log.1 = NONE                   # Disable NF_LOG_ULOG
net.netfilter.nf_log.10 = nf_log_ipv6           # Essential IPv6 logging
net.netfilter.nf_log.2 = nf_log_ipv4            # Essential IPv4 logging
net.netfilter.nf_log.3 = NONE                   # Disable ARP logging
net.netfilter.nf_log.4 = NONE                   # Disable NF_LOG_BRIDGE
net.netfilter.nf_log.5 = NONE                   # Disable NETDEV logging
net.netfilter.nf_log.6 = NONE                   # Disable NF_LOG_IP6
net.netfilter.nf_log.7 = NONE                   # Disable NF_LOG_EBTABLES
net.netfilter.nf_log.8 = NONE                   # Disable NF_LOG_IP5
net.netfilter.nf_log.9 = NONE                   # Disable NF_LOG_IP4
net.netfilter.nf_log_all_netns = 0              # Contain logging to main namespace


# MAXIMUM SECURITY NET.CORE SETTINGS
# ==================================

# --- BPF JIT Compiler Security ---
net.core.bpf_jit_enable = 1                     # Enable BPF JIT (required for security features)
net.core.bpf_jit_harden = 2                     # Maximum hardening (0→2: enable blinding, constant blinding)
net.core.bpf_jit_kallsyms = 0                   # Disable kernel symbols (prevent JIT bypasses)
net.core.bpf_jit_limit = 268435456              # Reduced from 528MB→256MB (DoS protection)

# --- Network Stack Hardening ---
net.core.busy_poll = 0                          # Disable busy polling (security/reduce CPU)
net.core.busy_read = 0                          # Disable busy read (security)
net.core.default_qdisc = fq_codel               # Maintain fair queuing (DoS protection)
net.core.dev_weight = 32                        # Reduced from 64 (mitigate interrupt storms)
net.core.dev_weight_rx_bias = 1                 # Maintain default
net.core.dev_weight_tx_bias = 1                 # Maintain default
net.core.devconf_inherit_init_net = 0           # Disable inheritance (security)
net.core.fb_tunnels_only_for_init_net = 1       # Restrict tunnels to init_net (1→enable)
net.core.flow_limit_cpu_bitmap = 0              # Disable flow limiting (0→use default)
net.core.flow_limit_table_len = 512             # Reduced from 4096 (memory protection)
net.core.gro_normal_batch = 4                   # Reduced from 8 (smaller batches for security)
net.core.high_order_alloc_disable = 1           # Disable high-order allocations (fragmentation attack protection)
net.core.max_skb_frags = 12                     # Reduced from 17 (fragment attack mitigation)

# --- Memory Management ---
net.core.mem_pcpu_rsv = 128                     # Reduced from 256 (memory conservation)
net.core.message_burst = 5                      # Reduced from 10 (log flood protection)
net.core.message_cost = 10                      # Increased from 5 (rate limiting)
net.core.netdev_budget = 150                    # Reduced from 300 (interrupt mitigation)
net.core.netdev_budget_usecs = 1000             # Reduced from 2000μs (CPU protection)
net.core.netdev_max_backlog = 500               # Reduced from 1000 (DoS protection)
net.core.netdev_rss_key = ""                    # Clear RSS key (security through obscurity)

# --- Protocol Hardening ---
net.core.netdev_tstamp_prequeue = 0             # Disable timestamp prequeue (0→security)
net.core.netdev_unregister_timeout_secs = 5     # Reduced from 10s (faster cleanup)
net.core.optmem_max = 65536                     # Reduced from 131072 (socket option memory limit)
net.core.rmem_default = 16384                   # Reduced from 212992 (memory exhaustion protection)
net.core.rmem_max = 7310720                     # Reduced from 212992 (read buffer limit)
net.core.rps_default_mask = 0                   # Disable RPS (security)
net.core.rps_sock_flow_entries = 0              # Disable RPS sock flow entries
net.core.skb_defer_max = 32                     # Reduced from 64 (memory protection)
net.core.somaxconn = 1024                       # Reduced from 4096 (SYN flood protection)
net.core.tstamp_allow_data = 0                  # Disallow timestamps with data (0→security)
net.core.txrehash = 1                           # Enable TX rehashing (security)
net.core.warnings = 0                           # Disable warnings (reduce log noise)
net.core.wmem_default = 16384                   # Reduced from 212992 (write buffer default)
net.core.wmem_max = 7310720                     # Reduced from 212992 (write buffer limit)

# --- IPsec/XFRM Hardening ---
net.core.xfrm_acq_expires = 15                  # Reduced from 30s (security)
net.core.xfrm_aevent_etime = 5                  # Reduced from 10s (event expiration)
net.core.xfrm_aevent_rseqth = 1                 # Reduced from 2 (event threshold)
net.core.xfrm_larval_drop = 1                   # Enable larval state drop (security)


# MAXIMUM SECURITY MPTCP SETTINGS
# ===============================

net.mptcp.add_addr_timeout = 30                 # Reduced from 120s (faster timeout for address changes)
net.mptcp.allow_join_initial_addr_port = 0      # Disabled (1→0: prevent potential session hijacking)
net.mptcp.available_path_managers = kernel      # Remove userspace (reduce attack surface)
net.mptcp.available_schedulers = default        # Maintain default scheduler
net.mptcp.blackhole_timeout = 600               # Reduced from 3600s (10min blackhole detection)
net.mptcp.checksum_enabled = 1                  # Enabled (0→1: mandatory for security)
net.mptcp.close_timeout = 30                    # Reduced from 60s (faster connection cleanup)
net.mptcp.enabled = 1                           # Keep MPTCP enabled (required for functionality)
net.mptcp.path_manager = kernel                 # Use kernel-space manager (security)
net.mptcp.pm_type = 0                           # Maintain fullmesh path management
net.mptcp.scheduler = default                   # Keep default scheduler
net.mptcp.stale_loss_cnt = 2                    # Reduced from 4 (faster subflow recovery)
net.mptcp.syn_retrans_before_tcp_fallback = 1   # Reduced from 2 (quicker fallback to TCP)




# MAXIMUM SECURITY IPV4/IPV6 SETTINGS
# ===================================

### IPv4 Hardening (all interfaces) ###
net.ipv4.conf.all.accept_local = 0              # Prevent accepting local packets from other interfaces
net.ipv4.conf.all.accept_redirects = 0          # Disable ICMP redirect acceptance (0→prevent MITM)
net.ipv4.conf.all.accept_source_route = 0       # Disable source routed packets (security)
net.ipv4.conf.all.arp_accept = 0                # Disable unsolicited ARP replies
net.ipv4.conf.all.arp_announce = 2              # Strict ARP announcement mode (prevent IP conflict)
net.ipv4.conf.all.arp_evict_nocarrier = 1       # Maintain enabled (cleanup ARP on link down)
net.ipv4.conf.all.arp_filter = 1                # Enable ARP filtering (prevent ARP spoofing)
net.ipv4.conf.all.arp_ignore = 1                # Ignore ARP requests for non-local IPs
net.ipv4.conf.all.arp_notify = 1                # Enable ARP notifications (security logging)
net.ipv4.conf.all.bc_forwarding = 0             # Disable broadcast forwarding (DoS protection)
net.ipv4.conf.all.bootp_relay = 0               # Disable BOOTP relay (security)
net.ipv4.conf.all.disable_policy = 0            # Maintain default (security)
net.ipv4.conf.all.disable_xfrm = 0              # Maintain default (IPsec security)
net.ipv4.conf.all.drop_gratuitous_arp = 1       # Enable (1→prevent ARP poisoning)
net.ipv4.conf.all.drop_unicast_in_l2_multicast = 1 # Enable (prevent L2 multicast spoofing)
net.ipv4.conf.all.force_igmp_version = 2        # Force IGMPv2 (prevent version downgrade attacks)
net.ipv4.conf.all.forwarding = 0                # Disable IP forwarding (unless router)
net.ipv4.conf.all.igmpv2_unsolicited_report_interval = 3000 # Reduced from 10000 (faster leave)
net.ipv4.conf.all.igmpv3_unsolicited_report_interval = 500  # Reduced from 1000
net.ipv4.conf.all.ignore_routes_with_linkdown = 1 # Enable (prevent stale routes)
net.ipv4.conf.all.log_martians = 1              # Enable (1→log suspicious packets)
net.ipv4.conf.all.mc_forwarding = 0             # Disable multicast forwarding
net.ipv4.conf.all.medium_id = 0                 # Maintain default
net.ipv4.conf.all.promote_secondaries = 1       # Enable (1→preserve addresses on failover)
net.ipv4.conf.all.proxy_arp = 0                 # Disable proxy ARP (security)
net.ipv4.conf.all.proxy_arp_pvlan = 0           # Disable private VLAN proxy ARP
net.ipv4.conf.all.route_localnet = 0            # Disable routing of localnet addresses
net.ipv4.conf.all.rp_filter = 1                 # Strict reverse path filtering (1→enabled)
net.ipv4.conf.all.secure_redirects = 0          # Disable all redirects (0→security)
net.ipv4.conf.all.send_redirects = 0            # Disable sending redirects (security)
net.ipv4.conf.all.shared_media = 0              # Disable (0→prevent routing to shared media)
net.ipv4.conf.all.src_valid_mark = 0            # Maintain default
net.ipv4.conf.all.tag = 0                       # Maintain default

### IPv6 Hardening (all interfaces) ###
net.ipv6.conf.all.accept_dad = 1                # Enable DAD (1→prevent address conflicts)
net.ipv6.conf.all.accept_ra = 0                 # Disable router advertisements (0→prevent RA attacks)
net.ipv6.conf.all.accept_ra_defrtr = 0          # Disable (requires accept_ra=0)
net.ipv6.conf.all.accept_ra_from_local = 0      # Disable local RA acceptance
net.ipv6.conf.all.accept_ra_min_hop_limit = 1   # Maintain minimum hop limit
net.ipv6.conf.all.accept_ra_min_lft = 0         # Maintain default
net.ipv6.conf.all.accept_ra_mtu = 0             # Disable RA MTU acceptance (security)
net.ipv6.conf.all.accept_ra_pinfo = 0           # Disable prefix information acceptance
net.ipv6.conf.all.accept_ra_rt_info_max_plen = 0 # Disable route information
net.ipv6.conf.all.accept_ra_rt_info_min_plen = 0 # Disable route information
net.ipv6.conf.all.accept_ra_rtr_pref = 0        # Disable router preference
net.ipv6.conf.all.accept_redirects = 0          # Disable ICMPv6 redirects (prevent MITM)
net.ipv6.conf.all.accept_source_route = 0       # Disable IPv6 source routing
net.ipv6.conf.all.accept_untracked_na = 0       # Disable untracked NA acceptance
net.ipv6.conf.all.addr_gen_mode = 1             # Stable privacy addressing (1→prevent tracking)
net.ipv6.conf.all.autoconf = 0                  # Disable autoconfiguration (security)
net.ipv6.conf.all.dad_transmits = 2             # Increase from 1 (improve DAD reliability)
net.ipv6.conf.all.disable_ipv6 = 0              # Keep IPv6 enabled
net.ipv6.conf.all.disable_policy = 0            # Maintain default
net.ipv6.conf.all.drop_unicast_in_l2_multicast = 1 # Enable (prevent L2 multicast spoofing)
net.ipv6.conf.all.drop_unsolicited_na = 1       # Enable (1→prevent NA flooding)
net.ipv6.conf.all.enhanced_dad = 1              # Enable enhanced DAD protection
net.ipv6.conf.all.force_mld_version = 1         # Force MLDv1 (prevent downgrade attacks)
net.ipv6.conf.all.force_tllao = 0               # Disable forced TLLAO (security)
net.ipv6.conf.all.forwarding = 0                # Disable IPv6 forwarding (unless router)
net.ipv6.conf.all.hop_limit = 64                # Maintain default hop limit
net.ipv6.conf.all.ignore_routes_with_linkdown = 1 # Enable (prevent stale routes)
net.ipv6.conf.all.ioam6_enabled = 0             # Disable IOAM (security)
net.ipv6.conf.all.ioam6_id = 65535              # Maintain default
net.ipv6.conf.all.ioam6_id_wide = 4294967295    # Maintain default
net.ipv6.conf.all.keep_addr_on_down = 0         # Disable (0→security)
net.ipv6.conf.all.max_addresses = 3             # Reduced from 16 (prevent address exhaustion)
net.ipv6.conf.all.max_desync_factor = 300       # Reduced from 600 (temporary address security)
net.ipv6.conf.all.mc_forwarding = 0             # Disable multicast forwarding
net.ipv6.conf.all.mldv1_unsolicited_report_interval = 3000 # Reduced from 10000
net.ipv6.conf.all.mldv2_unsolicited_report_interval = 500  # Reduced from 1000
net.ipv6.conf.all.mtu = 1280                    # Maintain minimum MTU
net.ipv6.conf.all.ndisc_evict_nocarrier = 1     # Maintain enabled
net.ipv6.conf.all.ndisc_notify = 1              # Enable (1→security notifications)
net.ipv6.conf.all.ndisc_tclass = 0              # Maintain default
net.ipv6.conf.all.optimistic_dad = 0            # Disable optimistic DAD (security)
net.ipv6.conf.all.proxy_ndp = 0                 # Disable proxy NDP (security)
net.ipv6.conf.all.ra_defrtr_metric = 1024       # Maintain default
net.ipv6.conf.all.ra_honor_pio_life = 0         # Disable (security)
net.ipv6.conf.all.ra_honor_pio_pflag = 0        # Disable (security)
net.ipv6.conf.all.regen_max_retry = 2           # Reduced from 3 (security)
net.ipv6.conf.all.regen_min_advance = 5         # Increased from 2 (temporary address security)
net.ipv6.conf.all.router_probe_interval = 60    # Maintain default
net.ipv6.conf.all.router_solicitation_delay = 1 # Maintain default
net.ipv6.conf.all.router_solicitation_interval = 10 # Increased from 4 (reduce solicitation)
net.ipv6.conf.all.router_solicitation_max_interval = 600 # Reduced from 3600
net.ipv6.conf.all.router_solicitations = 3      # Limited from -1 (3→prevent flooding)
net.ipv6.conf.all.rpl_seg_enabled = 0           # Disable RPL (security)
net.ipv6.conf.all.seg6_enabled = 0              # Disable Segment Routing (security)
net.ipv6.conf.all.seg6_require_hmac = 0         # Maintain disabled
net.ipv6.conf.all.suppress_frag_ndisc = 1       # Maintain enabled
net.ipv6.conf.all.temp_prefered_lft = 14400     # Reduced from 86400 (4 hour privacy)
net.ipv6.conf.all.temp_valid_lft = 28800        # Reduced from 604800 (8 hour privacy)
net.ipv6.conf.all.use_oif_addrs_only = 0        # Maintain default
net.ipv6.conf.all.use_optimistic = 0            # Disable optimistic addresses
net.ipv6.conf.all.use_tempaddr = 2              # Prefer temporary addresses (2→privacy)


# MAXIMUM SECURITY DEFAULT INTERFACE SETTINGS
# ==========================================

### IPv4 Default Interface Hardening ###
net.ipv4.conf.default.accept_local = 0              # Prevent accepting local packets from other interfaces
net.ipv4.conf.default.accept_redirects = 0          # Disable ICMP redirect acceptance (security)
net.ipv4.conf.default.accept_source_route = 0       # Disable source routed packets
net.ipv4.conf.default.arp_accept = 0                # Disable unsolicited ARP replies
net.ipv4.conf.default.arp_announce = 2              # Strict ARP announcement mode
net.ipv4.conf.default.arp_evict_nocarrier = 1       # Maintain cleanup on link down
net.ipv4.conf.default.arp_filter = 1                # Enable ARP filtering (anti-spoofing)
net.ipv4.conf.default.arp_ignore = 1                # Ignore ARP for non-local IPs
net.ipv4.conf.default.arp_notify = 1                # Enable ARP notifications
net.ipv4.conf.default.bc_forwarding = 0             # Disable broadcast forwarding
net.ipv4.conf.default.bootp_relay = 0               # Disable BOOTP relay
net.ipv4.conf.default.disable_policy = 0            # Maintain default
net.ipv4.conf.default.disable_xfrm = 0              # Maintain default
net.ipv4.conf.default.drop_gratuitous_arp = 1       # Block gratuitous ARP (anti-poisoning)
net.ipv4.conf.default.drop_unicast_in_l2_multicast = 1 # Prevent L2 multicast spoofing
net.ipv4.conf.default.force_igmp_version = 2        # Force IGMPv2 (prevent downgrade)
net.ipv4.conf.default.forwarding = 0                # Disable forwarding (unless router)
net.ipv4.conf.default.igmpv2_unsolicited_report_interval = 3000 # Reduced report interval
net.ipv4.conf.default.igmpv3_unsolicited_report_interval = 500  # Reduced report interval
net.ipv4.conf.default.ignore_routes_with_linkdown = 1 # Ignore routes on link down
net.ipv4.conf.default.log_martians = 1              # Log suspicious packets
net.ipv4.conf.default.mc_forwarding = 0             # Disable multicast forwarding
net.ipv4.conf.default.medium_id = 0                 # Maintain default
net.ipv4.conf.default.promote_secondaries = 1       # Preserve secondary addresses
net.ipv4.conf.default.proxy_arp = 0                 # Disable proxy ARP
net.ipv4.conf.default.proxy_arp_pvlan = 0           # Disable private VLAN proxy ARP
net.ipv4.conf.default.route_localnet = 0            # Disable localnet routing
net.ipv4.conf.default.rp_filter = 1                 # Strict reverse path filtering
net.ipv4.conf.default.secure_redirects = 0          # Disable all redirects
net.ipv4.conf.default.send_redirects = 0            # Disable sending redirects
net.ipv4.conf.default.shared_media = 0              # Disable shared media routing
net.ipv4.conf.default.src_valid_mark = 0            # Maintain default
net.ipv4.conf.default.tag = 0                       # Maintain default

### IPv6 Default Interface Hardening ###
net.ipv6.conf.default.accept_dad = 1                # Enable DAD (address conflict detection)
net.ipv6.conf.default.accept_ra = 0                 # Disable router advertisements
net.ipv6.conf.default.accept_ra_defrtr = 0          # Disable default router acceptance
net.ipv6.conf.default.accept_ra_from_local = 0      # Disable local RA acceptance
net.ipv6.conf.default.accept_ra_min_hop_limit = 1   # Maintain minimum hop limit
net.ipv6.conf.default.accept_ra_min_lft = 0         # Maintain default
net.ipv6.conf.default.accept_ra_mtu = 0             # Disable RA MTU acceptance
net.ipv6.conf.default.accept_ra_pinfo = 0           # Disable prefix information
net.ipv6.conf.default.accept_ra_rt_info_max_plen = 0 # Disable route information
net.ipv6.conf.default.accept_ra_rt_info_min_plen = 0 # Disable route information
net.ipv6.conf.default.accept_ra_rtr_pref = 0        # Disable router preference
net.ipv6.conf.default.accept_redirects = 0          # Disable ICMPv6 redirects
net.ipv6.conf.default.accept_source_route = 0       # Disable source routing
net.ipv6.conf.default.accept_untracked_na = 0       # Disable untracked NA
net.ipv6.conf.default.addr_gen_mode = 1             # Stable privacy addressing
net.ipv6.conf.default.autoconf = 0                  # Disable autoconfiguration
net.ipv6.conf.default.dad_transmits = 2             # Increase DAD transmits
net.ipv6.conf.default.disable_ipv6 = 0              # Keep IPv6 enabled
net.ipv6.conf.default.disable_policy = 0            # Maintain default
net.ipv6.conf.default.drop_unicast_in_l2_multicast = 1 # Prevent L2 multicast spoofing
net.ipv6.conf.default.drop_unsolicited_na = 1       # Drop unsolicited NAs
net.ipv6.conf.default.enhanced_dad = 1              # Enable enhanced DAD
net.ipv6.conf.default.force_mld_version = 1         # Force MLDv1
net.ipv6.conf.default.force_tllao = 0               # Disable forced TLLAO
net.ipv6.conf.default.forwarding = 0                # Disable forwarding
net.ipv6.conf.default.hop_limit = 64                # Maintain hop limit
net.ipv6.conf.default.ignore_routes_with_linkdown = 1 # Ignore routes on link down
net.ipv6.conf.default.ioam6_enabled = 0             # Disable IOAM
net.ipv6.conf.default.ioam6_id = 65535              # Maintain default
net.ipv6.conf.default.ioam6_id_wide = 4294967295    # Maintain default
net.ipv6.conf.default.keep_addr_on_down = 0         # Disable address retention
net.ipv6.conf.default.max_addresses = 3             # Limit addresses per interface
net.ipv6.conf.default.max_desync_factor = 300       # Reduced desync factor
net.ipv6.conf.default.mc_forwarding = 0             # Disable multicast forwarding
net.ipv6.conf.default.mldv1_unsolicited_report_interval = 3000 # Reduced report interval
net.ipv6.conf.default.mldv2_unsolicited_report_interval = 500  # Reduced report interval
net.ipv6.conf.default.mtu = 1280                    # Maintain minimum MTU
net.ipv6.conf.default.ndisc_evict_nocarrier = 1     # Maintain cleanup on carrier loss
net.ipv6.conf.default.ndisc_notify = 1              # Enable neighbor discovery notifications
net.ipv6.conf.default.ndisc_tclass = 0              # Maintain default traffic class
net.ipv6.conf.default.optimistic_dad = 0            # Disable optimistic DAD
net.ipv6.conf.default.proxy_ndp = 0                 # Disable proxy NDP
net.ipv6.conf.default.ra_defrtr_metric = 1024       # Maintain default metric
net.ipv6.conf.default.ra_honor_pio_life = 0         # Disable prefix information lifetime
net.ipv6.conf.default.ra_honor_pio_pflag = 0        # Disable prefix information flag
net.ipv6.conf.default.regen_max_retry = 2           # Reduced regeneration retries
net.ipv6.conf.default.regen_min_advance = 5         # Increased regeneration advance
net.ipv6.conf.default.router_probe_interval = 60    # Maintain probe interval
net.ipv6.conf.default.router_solicitation_delay = 1 # Maintain solicitation delay
net.ipv6.conf.default.router_solicitation_interval = 10 # Increased solicitation interval
net.ipv6.conf.default.router_solicitation_max_interval = 600 # Reduced max solicitation interval
net.ipv6.conf.default.router_solicitations = 3      # Limit router solicitations
net.ipv6.conf.default.rpl_seg_enabled = 0           # Disable RPL
net.ipv6.conf.default.seg6_enabled = 0              # Disable Segment Routing
net.ipv6.conf.default.seg6_require_hmac = 0         # Maintain disabled
net.ipv6.conf.default.suppress_frag_ndisc = 1       # Maintain fragment suppression
net.ipv6.conf.default.temp_prefered_lft = 14400     # Reduced temporary preferred lifetime (4 hours)
net.ipv6.conf.default.temp_valid_lft = 28800        # Reduced temporary valid lifetime (8 hours)
net.ipv6.conf.default.use_oif_addrs_only = 0        # Maintain default
net.ipv6.conf.default.use_optimistic = 0            # Disable optimistic addresses
net.ipv6.conf.default.use_tempaddr = 2              # Prefer temporary addresses


# MAXIMUM SECURITY WLAN0 SETTINGS (WIRELESS INTERFACE)
# ===================================================

### IPv4 Hardening (wlan0) ###
net.ipv4.conf.wlan0.accept_local = 0            # Prevent IP spoofing from local addresses
net.ipv4.conf.wlan0.accept_redirects = 0        # Disable ICMP redirects (critical for wireless security)
net.ipv4.conf.wlan0.accept_source_route = 0     # Block source-routed packets
net.ipv4.conf.wlan0.arp_accept = 0              # Disable unsolicited ARP replies
net.ipv4.conf.wlan0.arp_announce = 2            # Strict ARP announcement mode (prevents ARP poisoning)
net.ipv4.conf.wlan0.arp_evict_nocarrier = 1     # Maintain ARP cleanup on disconnect
net.ipv4.conf.wlan0.arp_filter = 1              # Enable ARP filtering (anti-spoofing)
net.ipv4.conf.wlan0.arp_ignore = 1              # Ignore ARP for non-local IPs
net.ipv4.conf.wlan0.arp_notify = 1              # Enable ARP notifications
net.ipv4.conf.wlan0.bc_forwarding = 0           # Disable broadcast forwarding
net.ipv4.conf.wlan0.bootp_relay = 0             # Disable BOOTP relay
net.ipv4.conf.wlan0.disable_policy = 0          # Maintain default
net.ipv4.conf.wlan0.disable_xfrm = 0            # Maintain default
net.ipv4.conf.wlan0.drop_gratuitous_arp = 1     # Block gratuitous ARP (prevents poisoning attacks)
net.ipv4.conf.wlan0.drop_unicast_in_l2_multicast = 1 # Prevent multicast spoofing
net.ipv4.conf.wlan0.force_igmp_version = 2      # Force IGMPv2 (prevent downgrade attacks)
net.ipv4.conf.wlan0.forwarding = 0              # Disable forwarding (client mode)
net.ipv4.conf.wlan0.igmpv2_unsolicited_report_interval = 3000 # Faster leave detection
net.ipv4.conf.wlan0.igmpv3_unsolicited_report_interval = 500  # Reduced report interval
net.ipv4.conf.wlan0.ignore_routes_with_linkdown = 1 # Ignore routes when disconnected
net.ipv4.conf.wlan0.log_martians = 1            # Log suspicious packets (critical for wireless)
net.ipv4.conf.wlan0.mc_forwarding = 0           # Disable multicast forwarding
net.ipv4.conf.wlan0.medium_id = 0               # Maintain default
net.ipv4.conf.wlan0.promote_secondaries = 1     # Preserve addresses during reconnection
net.ipv4.conf.wlan0.proxy_arp = 0               # Disable proxy ARP
net.ipv4.conf.wlan0.proxy_arp_pvlan = 0         # Disable private VLAN proxy ARP
net.ipv4.conf.wlan0.route_localnet = 0          # Disable localnet routing
net.ipv4.conf.wlan0.rp_filter = 1               # Strict reverse path filtering
net.ipv4.conf.wlan0.secure_redirects = 0        # Disable all redirects
net.ipv4.conf.wlan0.send_redirects = 0          # Disable sending redirects
net.ipv4.conf.wlan0.shared_media = 0            # Disable shared media routing
net.ipv4.conf.wlan0.src_valid_mark = 0          # Maintain default
net.ipv4.conf.wlan0.tag = 0                     # Maintain default

### IPv6 Hardening (wlan0) ###
net.ipv6.conf.wlan0.accept_dad = 1              # Enable DAD (address conflict detection)
net.ipv6.conf.wlan0.accept_ra = 0               # Disable RAs (critical for public Wi-Fi security)
net.ipv6.conf.wlan0.accept_ra_defrtr = 0        # Disable default router acceptance
net.ipv6.conf.wlan0.accept_ra_from_local = 0    # Disable local RA acceptance
net.ipv6.conf.wlan0.accept_ra_min_hop_limit = 1 # Maintain minimum hop limit
net.ipv6.conf.wlan0.accept_ra_min_lft = 0       # Maintain default
net.ipv6.conf.wlan0.accept_ra_mtu = 0           # Disable RA MTU acceptance
net.ipv6.conf.wlan0.accept_ra_pinfo = 0         # Disable prefix information
net.ipv6.conf.wlan0.accept_ra_rt_info_max_plen = 0 # Disable route information
net.ipv6.conf.wlan0.accept_ra_rt_info_min_plen = 0 # Disable route information
net.ipv6.conf.wlan0.accept_ra_rtr_pref = 0      # Disable router preference
net.ipv6.conf.wlan0.accept_redirects = 0        # Disable ICMPv6 redirects (prevents wireless MITM)
net.ipv6.conf.wlan0.accept_source_route = 0     # Disable source routing
net.ipv6.conf.wlan0.accept_untracked_na = 0     # Disable untracked NA
net.ipv6.conf.wlan0.addr_gen_mode = 1           # Stable privacy addressing
net.ipv6.conf.wlan0.autoconf = 0                # Disable autoconfiguration (manual IP preferred)
net.ipv6.conf.wlan0.dad_transmits = 2           # Increase DAD transmits for reliability
net.ipv6.conf.wlan0.disable_ipv6 = 0            # Keep IPv6 enabled
net.ipv6.conf.wlan0.disable_policy = 0          # Maintain default
net.ipv6.conf.wlan0.drop_unicast_in_l2_multicast = 1 # Prevent multicast spoofing
net.ipv6.conf.wlan0.drop_unsolicited_na = 1     # Drop unsolicited NAs (anti-flooding)
net.ipv6.conf.wlan0.enhanced_dad = 1            # Enable enhanced DAD
net.ipv6.conf.wlan0.force_mld_version = 1       # Force MLDv1
net.ipv6.conf.wlan0.force_tllao = 0             # Disable forced TLLAO
net.ipv6.conf.wlan0.forwarding = 0              # Disable forwarding
net.ipv6.conf.wlan0.hop_limit = 64              # Maintain hop limit
net.ipv6.conf.wlan0.ignore_routes_with_linkdown = 1 # Ignore routes when disconnected
net.ipv6.conf.wlan0.ioam6_enabled = 0           # Disable IOAM
net.ipv6.conf.wlan0.ioam6_id = 65535            # Maintain default
net.ipv6.conf.wlan0.ioam6_id_wide = 4294967295  # Maintain default
net.ipv6.conf.wlan0.keep_addr_on_down = 0       # Clear addresses on disconnect (security)
net.ipv6.conf.wlan0.max_addresses = 2           # Strict limit (2 addresses max for privacy)
net.ipv6.conf.wlan0.max_desync_factor = 300     # Reduced desync factor
net.ipv6.conf.wlan0.mc_forwarding = 0           # Disable multicast forwarding
net.ipv6.conf.wlan0.mldv1_unsolicited_report_interval = 3000 # Reduced report interval
net.ipv6.conf.wlan0.mldv2_unsolicited_report_interval = 500  # Reduced report interval
net.ipv6.conf.wlan0.mtu = 1500                  # Maintain standard MTU
net.ipv6.conf.wlan0.ndisc_evict_nocarrier = 1   # Maintain cleanup on disconnect
net.ipv6.conf.wlan0.ndisc_notify = 1            # Enable notifications (security monitoring)
net.ipv6.conf.wlan0.ndisc_tclass = 0            # Maintain default
net.ipv6.conf.wlan0.optimistic_dad = 0          # Disable optimistic DAD
net.ipv6.conf.wlan0.proxy_ndp = 0               # Disable proxy NDP
net.ipv6.conf.wlan0.ra_defrtr_metric = 1024     # Maintain default
net.ipv6.conf.wlan0.ra_honor_pio_life = 0       # Disable prefix lifetime
net.ipv6.conf.wlan0.ra_honor_pio_pflag = 0      # Disable prefix flag
net.ipv6.conf.wlan0.regen_max_retry = 2         # Reduced regeneration retries
net.ipv6.conf.wlan0.regen_min_advance = 5       # Increased regeneration advance
net.ipv6.conf.wlan0.router_probe_interval = 60  # Maintain probe interval
net.ipv6.conf.wlan0.router_solicitation_delay = 1 # Maintain delay
net.ipv6.conf.wlan0.router_solicitation_interval = 10 # Increased interval
net.ipv6.conf.wlan0.router_solicitation_max_interval = 600 # Reduced max interval
net.ipv6.conf.wlan0.router_solicitations = 2    # Limited solicitations (2 attempts)
net.ipv6.conf.wlan0.rpl_seg_enabled = 0         # Disable RPL
net.ipv6.conf.wlan0.seg6_enabled = 0            # Disable Segment Routing
net.ipv6.conf.wlan0.seg6_require_hmac = 0       # Maintain disabled
net.ipv6.conf.wlan0.suppress_frag_ndisc = 1     # Maintain fragment suppression
net.ipv6.conf.wlan0.temp_prefered_lft = 7200    # Short-lived temporary addresses (2 hours)
net.ipv6.conf.wlan0.temp_valid_lft = 14400      # Temporary valid lifetime (4 hours)
net.ipv6.conf.wlan0.use_oif_addrs_only = 0      # Maintain default
net.ipv6.conf.wlan0.use_optimistic = 0          # Disable optimistic addresses
net.ipv6.conf.wlan0.use_tempaddr = 2            # Prefer temporary addresses (privacy)

### Core Network Inheritance ###
net.core.devconf_inherit_init_net = 0           # Disable inheritance (security)


# SECURE LOOPBACK INTERFACE (lo) CONFIGURATION
# ===========================================
# Loopback is a virtual interface for internal communication.
# These settings maximize security while allowing local services to function.

### IPv4 Settings (lo) ###
net.ipv4.conf.lo.accept_local = 1                # Allow local packets (required for loopback)
net.ipv4.conf.lo.accept_redirects = 0            # Disable redirects (unnecessary on loopback)
net.ipv4.conf.lo.accept_source_route = 0         # Disable source routing (security)
net.ipv4.conf.lo.arp_accept = 0                  # Disable ARP (not applicable to loopback)
net.ipv4.conf.lo.arp_announce = 0                # Not applicable
net.ipv4.conf.lo.arp_evict_nocarrier = 1         # Maintain cleanup setting
net.ipv4.conf.lo.arp_filter = 0                  # Disable ARP filtering (not needed)
net.ipv4.conf.lo.arp_ignore = 0                  # Not applicable
net.ipv4.conf.lo.arp_notify = 0                  # Disable notifications
net.ipv4.conf.lo.bc_forwarding = 0               # Disable broadcast forwarding
net.ipv4.conf.lo.bootp_relay = 0                 # Disable BOOTP relay
net.ipv4.conf.lo.disable_policy = 1              # Disable IPsec policy (improves performance)
net.ipv4.conf.lo.disable_xfrm = 1                # Disable IPsec transforms (security/performance)
net.ipv4.conf.lo.drop_gratuitous_arp = 0         # Allow gratuitous ARP (harmless on loopback)
net.ipv4.conf.lo.drop_unicast_in_l2_multicast = 0 # Disable (not applicable)
net.ipv4.conf.lo.force_igmp_version = 0          # No IGMP needed
net.ipv4.conf.lo.forwarding = 0                  # Disable forwarding
net.ipv4.conf.lo.igmpv2_unsolicited_report_interval = 0 # Disable IGMP reports
net.ipv4.conf.lo.igmpv3_unsolicited_report_interval = 0 # Disable IGMP reports
net.ipv4.conf.lo.ignore_routes_with_linkdown = 0 # Not applicable
net.ipv4.conf.lo.log_martians = 0                # Disable logging (reduces noise)
net.ipv4.conf.lo.mc_forwarding = 0               # Disable multicast forwarding
net.ipv4.conf.lo.medium_id = 0                   # Not applicable
net.ipv4.conf.lo.promote_secondaries = 1         # Preserve secondary addresses
net.ipv4.conf.lo.proxy_arp = 0                   # Disable proxy ARP
net.ipv4.conf.lo.proxy_arp_pvlan = 0             # Disable PVLAN proxy ARP
net.ipv4.conf.lo.route_localnet = 1              # Allow localnet routing (required for services)
net.ipv4.conf.lo.rp_filter = 0                   # Disable RPF (not needed for loopback)
net.ipv4.conf.lo.secure_redirects = 0            # Disable redirects
net.ipv4.conf.lo.send_redirects = 0              # Disable sending redirects
net.ipv4.conf.lo.shared_media = 0                # Disable shared media
net.ipv4.conf.lo.src_valid_mark = 0              # Maintain default
net.ipv4.conf.lo.tag = 0                         # Maintain default

### IPv6 Settings (lo) ###
net.ipv6.conf.lo.accept_dad = -1                 # Disable DAD (not needed for loopback)
net.ipv6.conf.lo.accept_ra = 0                   # Disable router advertisements
net.ipv6.conf.lo.accept_ra_defrtr = 0            # Disable default router
net.ipv6.conf.lo.accept_ra_from_local = 0        # Disable local RAs
net.ipv6.conf.lo.accept_ra_min_hop_limit = 1     # Maintain minimum hop limit
net.ipv6.conf.lo.accept_ra_min_lft = 0           # Maintain default
net.ipv6.conf.lo.accept_ra_mtu = 0               # Disable RA MTU
net.ipv6.conf.lo.accept_ra_pinfo = 0             # Disable prefix info
net.ipv6.conf.lo.accept_ra_rt_info_max_plen = 0  # Disable route info
net.ipv6.conf.lo.accept_ra_rt_info_min_plen = 0  # Disable route info
net.ipv6.conf.lo.accept_ra_rtr_pref = 0          # Disable router preference
net.ipv6.conf.lo.accept_redirects = 0            # Disable redirects
net.ipv6.conf.lo.accept_source_route = 0         # Disable source routing
net.ipv6.conf.lo.accept_untracked_na = 0         # Disable untracked NA
net.ipv6.conf.lo.addr_gen_mode = 0               # Maintain default
net.ipv6.conf.lo.autoconf = 0                    # Disable autoconfiguration
net.ipv6.conf.lo.dad_transmits = 0               # Disable DAD transmits
net.ipv6.conf.lo.disable_ipv6 = 0                # Keep IPv6 enabled
net.ipv6.conf.lo.disable_policy = 1              # Disable IPsec policy (performance)
net.ipv6.conf.lo.drop_unicast_in_l2_multicast = 0 # Disable (not applicable)
net.ipv6.conf.lo.drop_unsolicited_na = 0         # Allow NAs (harmless on loopback)
net.ipv6.conf.lo.enhanced_dad = 0                # Disable enhanced DAD
net.ipv6.conf.lo.force_mld_version = 0           # No MLD needed
net.ipv6.conf.lo.force_tllao = 0                 # Disable forced TLLAO
net.ipv6.conf.lo.forwarding = 0                  # Disable forwarding
net.ipv6.conf.lo.hop_limit = 64                  # Maintain hop limit
net.ipv6.conf.lo.ignore_routes_with_linkdown = 0 # Not applicable
net.ipv6.conf.lo.ioam6_enabled = 0               # Disable IOAM
net.ipv6.conf.lo.ioam6_id = 65535                # Maintain default
net.ipv6.conf.lo.ioam6_id_wide = 4294967295      # Maintain default
net.ipv6.conf.lo.keep_addr_on_down = 1           # Keep addresses on down (preserve state)
net.ipv6.conf.lo.max_addresses = 1               # Only need loopback address
net.ipv6.conf.lo.max_desync_factor = 0           # Disable desynchronization
net.ipv6.conf.lo.mc_forwarding = 0               # Disable multicast forwarding
net.ipv6.conf.lo.mldv1_unsolicited_report_interval = 0 # Disable MLD reports
net.ipv6.conf.lo.mldv2_unsolicited_report_interval = 0 # Disable MLD reports
net.ipv6.conf.lo.mtu = 65536                     # Large MTU for local efficiency
net.ipv6.conf.lo.ndisc_evict_nocarrier = 1       # Maintain cleanup
net.ipv6.conf.lo.ndisc_notify = 0                # Disable notifications
net.ipv6.conf.lo.ndisc_tclass = 0                # Maintain default
net.ipv6.conf.lo.optimistic_dad = 0              # Disable optimistic DAD
net.ipv6.conf.lo.proxy_ndp = 0                   # Disable proxy NDP
net.ipv6.conf.lo.ra_defrtr_metric = 1024         # Maintain default
net.ipv6.conf.lo.ra_honor_pio_life = 0           # Disable prefix lifetime
net.ipv6.conf.lo.ra_honor_pio_pflag = 0          # Disable prefix flag
net.ipv6.conf.lo.regen_max_retry = 0             # Disable regeneration
net.ipv6.conf.lo.regen_min_advance = 0           # Disable regeneration
net.ipv6.conf.lo.router_probe_interval = 0       # Disable probing
net.ipv6.conf.lo.router_solicitation_delay = 0   # Disable solicitation
net.ipv6.conf.lo.router_solicitation_interval = 0 # Disable solicitation
net.ipv6.conf.lo.router_solicitation_max_interval = 0 # Disable solicitation
net.ipv6.conf.lo.router_solicitations = 0        # Disable solicitations
net.ipv6.conf.lo.rpl_seg_enabled = 0             # Disable RPL
net.ipv6.conf.lo.seg6_enabled = 0                # Disable Segment Routing
net.ipv6.conf.lo.seg6_require_hmac = 0           # Maintain disabled
net.ipv6.conf.lo.suppress_frag_ndisc = 1         # Maintain fragment suppression
net.ipv6.conf.lo.temp_prefered_lft = 0           # Disable temporary addresses
net.ipv6.conf.lo.temp_valid_lft = 0              # Disable temporary addresses
net.ipv6.conf.lo.use_oif_addrs_only = 0          # Maintain default
net.ipv6.conf.lo.use_optimistic = 0              # Disable optimistic addresses
net.ipv6.conf.lo.use_tempaddr = -1               # Disable temporary addresses


# SECURE IPV4 STACK CONFIGURATION
# ===============================

### CIPSO (Security Labeling) ###
net.ipv4.cipso_cache_bucket_size = 10          # Maintain default cache size
net.ipv4.cipso_cache_enable = 1                # Enable caching (performance)
net.ipv4.cipso_rbm_optfmt = 0                  # Disable optimized format (security)
net.ipv4.cipso_rbm_strictvalid = 1             # Enable strict validation (security)

### Routing & Forwarding ###
net.ipv4.fib_multipath_hash_fields = 7         # Full hash fields (security)
net.ipv4.fib_multipath_hash_policy = 0         # L3/L4 hashing (security)
net.ipv4.fib_multipath_hash_seed = 0           # Disable custom seed (security)
net.ipv4.fib_multipath_use_neigh = 0           # Disable neighbor usage (security)
net.ipv4.fib_notify_on_flag_change = 1         # Enable notifications (security)
net.ipv4.fib_sync_mem = 524288                 # Maintain default
net.ipv4.fwmark_reflect = 0                    # Disable fwmark reflection (security)
net.ipv4.ip_forward = 0                        # Disable IP forwarding (security)
net.ipv4.ip_forward_update_priority = 0        # Disable priority update (security)
net.ipv4.ip_forward_use_pmtu = 0               # Disable PMTU for forwarding
net.ipv4.raw_l3mdev_accept = 0                 # Disable L3 device acceptance (security)

### ICMP Security ###
net.ipv4.icmp_echo_enable_probe = 0            # Disable echo probes (security)
net.ipv4.icmp_echo_ignore_all = 0              # Allow pings (functionality)
net.ipv4.icmp_echo_ignore_broadcasts = 1       # Ignore broadcast pings (security)
net.ipv4.icmp_errors_use_inbound_ifaddr = 1    # Use inbound interface (security)
net.ipv4.icmp_ignore_bogus_error_responses = 1 # Ignore bogus errors (security)
net.ipv4.icmp_msgs_burst = 20                  # Reduce burst from 50 (DoS protection)
net.ipv4.icmp_msgs_per_sec = 200               # Reduce from 1000 (DoS protection)
net.ipv4.icmp_ratelimit = 500                  # Reduce from 1000 (DoS protection)
net.ipv4.icmp_ratemask = 6168                  # Maintain default

### IGMP Security ###
net.ipv4.igmp_link_local_mcast_reports = 1     # Enable (functionality)
net.ipv4.igmp_max_memberships = 10             # Reduce from 20 (DoS protection)
net.ipv4.igmp_max_msf = 5                      # Reduce from 10 (DoS protection)
net.ipv4.igmp_qrv = 3                          # Increase robustness (security)

### IP Configuration ###
net.ipv4.inet_peer_maxttl = 300                # Reduce from 600 (memory protection)
net.ipv4.inet_peer_minttl = 60                 # Reduce from 120 (memory protection)
net.ipv4.inet_peer_threshold = 32768           # Reduce from 65664 (memory protection)
net.ipv4.ip_autobind_reuse = 0                 # Disable (security)
net.ipv4.ip_default_ttl = 64                   # Maintain default
net.ipv4.ip_dynaddr = 0                        # Disable dynamic addresses (security)
net.ipv4.ip_early_demux = 1                    # Enable (performance)
net.ipv4.ip_local_port_range = 32768 60999     # Maintain default
net.ipv4.ip_local_reserved_ports =             # Set critical ports: 22,80,443,53
net.ipv4.ip_no_pmtu_disc = 0                   # Enable PMTU discovery
net.ipv4.ip_nonlocal_bind = 0                  # Disable non-local binding (security)
net.ipv4.ip_unprivileged_port_start = 1024     # Maintain default

### IP Fragmentation Protection ###
net.ipv4.ipfrag_high_thresh = 1048576          # Reduce from 4MB (DoS protection)
net.ipv4.ipfrag_low_thresh = 786432            # Reduce accordingly
net.ipv4.ipfrag_max_dist = 32                  # Reduce from 64 (fragment attack)
net.ipv4.ipfrag_secret_interval = 600          # Enable rotation (security)
net.ipv4.ipfrag_time = 20                      # Reduce from 30 (DoS protection)

### Neighbor Cache Settings ###
# Global defaults
net.ipv4.neigh.default.base_reachable_time_ms = 15000  # Reduce from 30000 (security)
net.ipv4.neigh.default.gc_interval = 30        # Maintain
net.ipv4.neigh.default.gc_stale_time = 30      # Reduce from 60 (security)
net.ipv4.neigh.default.gc_thresh1 = 1024       # Increase from 128 (large networks)
net.ipv4.neigh.default.gc_thresh2 = 4096       # Increase from 512
net.ipv4.neigh.default.gc_thresh3 = 8192       # Increase from 1024
net.ipv4.neigh.default.interval_probe_time_ms = 3000   # Reduce from 5000
net.ipv4.neigh.default.mcast_solicit = 1       # Reduce from 3 (DoS protection)
net.ipv4.neigh.default.ucast_solicit = 2       # Reduce from 3 (security)
net.ipv4.neigh.default.unres_qlen = 32         # Reduce from 101 (DoS protection)

# wlan0 specific
net.ipv4.neigh.wlan0.base_reachable_time_ms = 10000    # Shorter for wireless
net.ipv4.neigh.wlan0.mcast_solicit = 1         # Reduce probes
net.ipv4.neigh.wlan0.ucast_solicit = 2         # Reduce probes

# Loopback (lo) - minimal settings
net.ipv4.neigh.lo.base_reachable_time_ms = 86400000 # Long timeout (1 day)
net.ipv4.neigh.lo.mcast_solicit = 0            # Disable multicast
net.ipv4.neigh.lo.ucast_solicit = 0            # Disable unicast

### TCP Security Hardening ###
net.ipv4.tcp_abort_on_overflow = 1             # Enable on overflow (security)
net.ipv4.tcp_adv_win_scale = 1                 # Maintain default
net.ipv4.tcp_allowed_congestion_control = cubic # Allow only cubic
net.ipv4.tcp_app_win = 31                      # Maintain default
net.ipv4.tcp_autocorking = 1                   # Enable (performance)
net.ipv4.tcp_available_congestion_control = cubic
net.ipv4.tcp_backlog_ack_defer = 0             # Disable (security)
net.ipv4.tcp_base_mss = 1024                   # Maintain
net.ipv4.tcp_challenge_ack_limit = 100         # Reduce from 2B (security)
net.ipv4.tcp_comp_sack_delay_ns = 2000000      # Increase delay (security)
net.ipv4.tcp_comp_sack_nr = 10                 # Reduce from 44 (security)
net.ipv4.tcp_congestion_control = cubic        # Use cubic
net.ipv4.tcp_dsack = 0                         # Disable DSACK (security)
net.ipv4.tcp_early_demux = 1                   # Enable (performance)
net.ipv4.tcp_early_retrans = 2                 # Reduce from 3 (security)
net.ipv4.tcp_ecn = 1                           # Enable ECN (RFC)
net.ipv4.tcp_ecn_fallback = 1                  # Enable fallback
net.ipv4.tcp_fack = 0                          # Disable FACK (security)
net.ipv4.tcp_fastopen = 1                      # Enable TFO (performance)
net.ipv4.tcp_fastopen_blackhole_timeout_sec = 3600 # Set blackhole timeout
net.ipv4.tcp_fastopen_key =                    # Rotate regularly in practice
net.ipv4.tcp_fin_timeout = 30                  # Reduce from 60 (security)
net.ipv4.tcp_frto = 2                          # Maintain
net.ipv4.tcp_fwmark_accept = 0                 # Disable (security)
net.ipv4.tcp_invalid_ratelimit = 250           # Reduce from 500 (security)
net.ipv4.tcp_keepalive_intvl = 30              # Reduce from 75 (security)
net.ipv4.tcp_keepalive_probes = 5              # Reduce from 9 (security)
net.ipv4.tcp_keepalive_time = 600              # Reduce from 1200 (security)
net.ipv4.tcp_limit_output_bytes = 262144       # Reduce from 1MB (DoS)
net.ipv4.tcp_max_orphans = 16384               # Reduce from 32768 (DoS)
net.ipv4.tcp_max_reordering = 200              # Reduce from 300 (security)
net.ipv4.tcp_max_syn_backlog = 1024            # Increase from 512 (security)
net.ipv4.tcp_max_tw_buckets = 16384            # Reduce from 32768 (DoS)
net.ipv4.tcp_mem = 65536 131072 262144         # Reduce memory usage (DoS)
net.ipv4.tcp_min_rtt_wlen = 100                # Reduce from 300 (security)
net.ipv4.tcp_min_tso_segs = 4                  # Increase from 2 (performance)
net.ipv4.tcp_moderate_rcvbuf = 1               # Enable (performance)
net.ipv4.tcp_mtu_probing = 2                   # Enable aggressive probing
net.ipv4.tcp_no_metrics_save = 1               # Disable metrics save (security)
net.ipv4.tcp_no_ssthresh_metrics_save = 1      # Disable (security)
net.ipv4.tcp_notsent_lowat = 16384             # Set reasonable buffer
net.ipv4.tcp_orphan_retries = 2                # Reduce from 0 (security)
net.ipv4.tcp_pacing_ca_ratio = 100             # Reduce from 120
net.ipv4.tcp_pacing_ss_ratio = 150             # Reduce from 200
net.ipv4.tcp_pingpong_thresh = 0               # Disable (security)
net.ipv4.tcp_recovery = 1                      # Enable RACK recovery
net.ipv4.tcp_reordering = 3                    # Maintain
net.ipv4.tcp_retries1 = 3                      # Maintain
net.ipv4.tcp_retries2 = 8                      # Reduce from 15 (security)
net.ipv4.tcp_rfc1337 = 1                       # Enable (security)
net.ipv4.tcp_rmem = 4096 87380 2516582         # Reduce max from 6MB (DoS)
net.ipv4.tcp_sack = 0                          # Disable SACK (security)
net.ipv4.tcp_slow_start_after_idle = 0         # Disable (performance)
net.ipv4.tcp_stdurg = 0                        # Disable (security)
net.ipv4.tcp_syn_linear_timeouts = 2           # Reduce from 4 (security)
net.ipv4.tcp_syn_retries = 3                   # Reduce from 6 (security)
net.ipv4.tcp_synack_retries = 3                # Reduce from 5 (security)
net.ipv4.tcp_syncookies = 2                    # Enable always (security)
net.ipv4.tcp_timestamps = 1                    # Enable (security)
net.ipv4.tcp_tw_reuse = 1                      # Enable reuse (performance)
net.ipv4.tcp_window_scaling = 1                # Enable
net.ipv4.tcp_wmem = 4096 16384 2516582         # Reduce max from 4MB (DoS)

### UDP Security ###
net.ipv4.udp_early_demux = 0                   # Disable (security)
net.ipv4.udp_l3mdev_accept = 0                 # Disable (security)
net.ipv4.udp_mem = 131070  262141  524288      # Reduce memory usage
net.ipv4.udp_rmem_min = 8192                   # Increase from 4096 (security)
net.ipv4.udp_wmem_min = 8192                   # Increase from 4096 (security)

### XFRM (IPsec) ###
net.ipv4.xfrm4_gc_thresh = 16384               # Reduce from 32768 (security)

# SECURE IPV6 STACK CONFIGURATION
# ===============================

### IPv6 Core Security ###
net.ipv6.anycast_src_echo_reply = 0            # Disable anycast echo replies (security)
net.ipv6.auto_flowlabels = 3                   # Enable flowlabels + privacy (RFC 8981)
net.ipv6.bindv6only = 0                        # Maintain dual-stack behavior
net.ipv6.calipso_cache_bucket_size = 10        # Maintain default
net.ipv6.calipso_cache_enable = 1              # Enable CALIPSO caching (performance)
net.ipv6.flowlabel_consistency = 1             # Enable flowlabel validation
net.ipv6.flowlabel_reflect = 0                 # Disable reflection (security)
net.ipv6.flowlabel_state_ranges = 0            # Disable state ranges (security)
net.ipv6.fwmark_reflect = 0                    # Disable fwmark reflection (security)
net.ipv6.idgen_delay = 4                       # Increase privacy delay (RFC 7217)
net.ipv6.idgen_retries = 1                     # Reduce retries (privacy/security)
net.ipv6.ip_nonlocal_bind = 0                  # Disable non-local binding (security)

### ICMPv6 Security ###
net.ipv6.icmp.echo_ignore_all = 0              # Allow pings (functionality)
net.ipv6.icmp.echo_ignore_anycast = 1          # Ignore anycast pings (security)
net.ipv6.icmp.echo_ignore_multicast = 1        # Ignore multicast pings (security)
net.ipv6.icmp.error_anycast_as_unicast = 0     # Disable anycast errors (security)
net.ipv6.icmp.ratelimit = 500                  # Reduce from 1000 (DoS protection)
net.ipv6.icmp.ratemask = 0-1,3-127             # Maintain default

### Fragmentation Protection ###
net.ipv6.ip6frag_high_thresh = 1048576         # Reduce from 4MB (DoS protection)
net.ipv6.ip6frag_low_thresh = 786432           # Reduce accordingly
net.ipv6.ip6frag_secret_interval = 600         # Enable secret rotation (security)
net.ipv6.ip6frag_time = 30                     # Reduce from 60 (DoS protection)

### Extension Header Limits ###
net.ipv6.max_dst_opts_length = 1024            # Reduce from 2GB (security)
net.ipv6.max_dst_opts_number = 2               # Reduce from 8 (security)
net.ipv6.max_hbh_length = 1024                 # Reduce from 2GB (security)
net.ipv6.max_hbh_opts_number = 2               # Reduce from 8 (security)

### Multicast Security ###
net.ipv6.mld_max_msf = 16                      # Reduce from 64 (DoS protection)
net.ipv6.mld_qrv = 3                           # Increase robustness (security)

### Neighbor Cache Settings ###
# Global defaults
net.ipv6.neigh.default.base_reachable_time_ms = 15000  # Reduce from 30000 (security)
net.ipv6.neigh.default.gc_stale_time = 30       # Reduce from 60 (security)
net.ipv6.neigh.default.gc_thresh1 = 1024        # Increase from 128
net.ipv6.neigh.default.gc_thresh2 = 4096        # Increase from 512
net.ipv6.neigh.default.gc_thresh3 = 8192        # Increase from 1024
net.ipv6.neigh.default.mcast_solicit = 1        # Reduce from 3 (DoS protection)
net.ipv6.neigh.default.ucast_solicit = 2        # Reduce from 3 (security)
net.ipv6.neigh.default.unres_qlen = 32          # Reduce from 101 (DoS protection)

# wlan0 specific (wireless)
net.ipv6.neigh.wlan0.base_reachable_time_ms = 10000    # Shorter for wireless
net.ipv6.neigh.wlan0.mcast_solicit = 1         # Reduce probes
net.ipv6.neigh.wlan0.ucast_solicit = 2         # Reduce probes

# Loopback (lo) - minimal settings
net.ipv6.neigh.lo.base_reachable_time_ms = 86400000 # Long timeout (1 day)
net.ipv6.neigh.lo.mcast_solicit = 0            # Disable multicast
net.ipv6.neigh.lo.ucast_solicit = 0            # Disable unicast

### Routing Security ###
net.ipv6.fib_multipath_hash_fields = 7         # Full hash fields (security)
net.ipv6.fib_multipath_hash_policy = 0         # L3/L4 hashing (security)
net.ipv6.fib_notify_on_flag_change = 1         # Enable notifications (security)
net.ipv6.route.gc_elasticity = 9               # Maintain default
net.ipv6.route.gc_interval = 30                # Maintain
net.ipv6.route.gc_min_interval_ms = 1000       # Increase from 500 (performance)
net.ipv6.route.gc_thresh = 2048                # Increase from 1024
net.ipv6.route.gc_timeout = 30                 # Reduce from 60 (security)
net.ipv6.route.min_adv_mss = 1220              # Maintain
net.ipv6.route.mtu_expires = 300               # Reduce from 600 (security)
net.ipv6.route.skip_notify_on_dev_down = 1     # Enable (performance)

### Segment Routing Security ###
net.ipv6.seg6_flowlabel = 0                    # Disable flowlabels (security)

### XFRM (IPsec) Security ###
net.ipv6.xfrm6_gc_thresh = 16384               # Reduce from 32768 (security)
